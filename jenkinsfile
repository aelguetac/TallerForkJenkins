node {

//        stage('Compile code') {
//           dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
//                sh 'mvn clean compile -e'
//           }
//            
//        }
//        stage('Test Code') {
//            dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
//             	    	sh 'mvn clean test -e'
//            }
//        }
//        stage('Jar Code') {
//            dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
//                	sh 'mvn clean package -e'
//            }
//        }
//        stage('Sonar scanner') {
//		dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
	//	def scannerHome = tool name:'sonar_scanner', type: 'hudson.plugins.sonar.SonarRunnerInstallation';
//			withSonarQubeEnv( installationName: 'sonar') {
//      			sh 'mvn org.sonarsource.scanner.maven:sonar-maven-plugin:3.7.0.1746:sonar'
	//	sh "${scannerHome}/bin/sonar-scanner"
//		}
//		}
//	}
        stage('Upload Nexus') {
		dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
		nexusPublisher nexusInstanceId: 'nexus', nexusRepositoryId: 'test-nexus', 
		packages: [[ $class: 'MavenPackage', MavenAssetList: [[classifier: 'RELEASE', extensions: 'jar' ,
		filePath: '/Users/EscalamientoSoporte/TallerForkJenkins/TallerForkJenkins/build/DevOpsUsach2020-0.0.1.jar']], 
		mavenCoordinate: [artifactId: 'DevOpsUsach2020', groupId: 'com.devopsusach2020', packaging : 'jar', version: '0.0.1']]]
		}

	}
// $class: 'MavenPackage', 
//      /Users/EscalamientoSoporte/TallerForkJenkins/TallerForkJenkins/build/classes/com/devopsusach2020/DevOpsUsach2020Application.jar
//	nexusVersion('nexus3')
//        	protocol('http')
//        	nexusUrl('http://localhost:8081/repository/test-nexus/')
//        	groupId('com.devopsusach2020')
//        	version('0.0.1')
//        	repository('test-nexus')
//        	credentialsId('44620c50-1589-4617-a677-7563985e46e1')
//        	artifact {
//            		artifactId('DevOpsUsach2020')
//            	type('jar')
//            	classifier('RELEASE')
//            	file('DevOpsUsach2020Application.jar')
//        }
//        artifact {
//            artifactId('DevOpsUsach2020')
//            type('jar')
//            classifier('RELEASE')
//            file('DevOpsUsach2020Application.jar')
//        }

//	stage('Run Jar') {
                    //dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
//                sh 'nohup mvn spring-boot:run &'
          //          }
//        }
//        stage('Test Curl QA') {
                    //dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
//                	sh 'sleep 40'
//                	sh 'curl -X GET \'http://localhost:8081/rest/mscovid/test?msg=testing\''
           // }
//        }
//        stage('EOF') {
                    //dir('C:\\Users\\EscalamientoSoporte\\TallerForkJenkins\\TallerForkJenkins') {
//                	echo 'Finaliza pipeline con sonar y //dir Alejandro Elgueta'
             //       }
//        }
}
